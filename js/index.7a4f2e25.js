import{C as V}from"./ConnectStatus.92169d5d.js";import{_ as C}from"./index.72c8105d.js";import{ah as c,o as y,c as z,V as a,P as i,a as o,U as d,ar as M,Q as B,T as w}from"./vendor-vue.cefe3aef.js";import{M as T}from"./monitor-status-enums.56211d6f.js";import"./element-plus.4ffcce52.js";import"./element-icon.1fe9d2a8.js";import"./vendor-lib.673ea722.js";const x={name:"",components:{ConnectStatus:V},props:{list:{type:Array}},computed:{},data(){return{currentRow:null,dialogVisible:!1}},methods:{handleEditRow(e){this.currentRow=e,this.dialogVisible=!0},async handleDeleteClick(e){let t={id:e.id};const n=await this.$http.function(t);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg)},async handleStatusChange(e){let t={id:e.id};const n=await this.$http.function(t);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg)},handleUpdateSuccess(){this.$emit("on-success")}},created(){}};function P(e,t,n,$,l,h){const r=c("el-table-column"),u=c("ConnectStatus"),m=c("el-table");return y(),z("div",null,[a(m,{data:n.list,stripe:"",border:""},{default:i(()=>[a(r,{label:e.$t("\u5E8F\u53F7"),align:"center",prop:"id",width:"60"},{default:i(s=>[o("span",null,d(s.$index+1),1)]),_:1},8,["label"]),a(r,{label:e.$t("\u5F00\u59CB\u65F6\u95F4"),"header-align":"center",align:"center",prop:"create_time",width:"180"},{default:i(s=>[o("span",null,d(s.row.create_time||"-"),1)]),_:1},8,["label"]),a(r,{label:e.$t("\u7ED3\u675F\u65F6\u95F4"),"header-align":"center",align:"center",prop:"update_time",width:"180"},{default:i(s=>[o("span",null,d(s.row.update_time||"-"),1)]),_:1},8,["label"]),a(r,{label:e.$t("\u6301\u7EED\u65F6\u95F4"),"header-align":"center",align:"center",width:"100",prop:"total_time_label"},{default:i(s=>[o("span",null,d(s.row.total_time_label||"-"),1)]),_:1},8,["label"]),a(r,{label:e.$t("\u72B6\u6001"),"header-align":"center",align:"center",prop:"status",width:"60"},{default:i(s=>[a(u,{value:s.row.status_value},null,8,["value"])]),_:1},8,["label"]),a(r,{label:e.$t("\u6267\u884C\u7ED3\u679C"),"header-align":"center",align:"center",prop:"status"},{default:i(s=>[o("span",null,d(s.row.result||"-"),1)]),_:1},8,["label"])]),_:1},8,["data"])])}const R=C(x,[["render",P]]),U={name:"log-scheduler-list",props:{monitorId:{type:String,default:null}},components:{DataTable:R},data(){return{list:[],total:0,page:1,size:20,keywords:"",detail:{},loading:!0,dialogVisible:!1,pageSizeCachekey:"pageSize"}},computed:{},methods:{resetData(){this.page=1,this.list=[],this.getData(),this.getMonitorData()},refreshData(){this.getData()},async getMonitorData(){let e={monitor_id:this.monitorId};const t=await this.$http.getMonitorById(e);t.ok&&(this.detail=t.data)},async getData(){this.loading=!0;let e={monitor_id:this.monitorId,page:this.page,size:this.size};const t=await this.$http.getLogMonitorList(e);t.code==0&&(this.list=t.data.list.map(n=>(n.status_value=T(n.status),n)),this.total=t.data.total),this.loading=!1},handleAddRow(){this.dialogVisible=!0},handleAddSuccess(){this.resetData()},handleSizeChange(e){localStorage.setItem(this.pageSizeCachekey,e),this.resetData()},loadPageSize(){let e=localStorage.getItem(this.pageSizeCachekey);e&&(this.size=parseInt(e))},async handleBatchDeleteConfirm(){let e=this.$loading({fullscreen:!0});try{const t=await this.$http.clearLogMonitor({monitor_id:this.monitorId});t.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.resetData()):this.$msg.error(t.msg)}catch(t){console.log(t)}finally{this.$nextTick(()=>{e.close()})}}},created(){this.loadPageSize(),this.resetData()}},A={class:"app-container"},L={class:"flex justify-between mb-sm"},N={class:"flex items-center"},j=o("span",{class:"color--info"},"\u76D1\u63A7\u540D\u79F0: ",-1),E={class:"ml-sm"},O=o("span",{class:"ml-md color--info"},"\u76D1\u63A7\u8BF7\u6C42: ",-1),F={class:"ml-sm"};function Q(e,t,n,$,l,h){var g,_,f,b,S;const r=c("el-link"),u=c("Delete"),m=c("el-icon"),s=c("el-popconfirm"),v=c("DataTable"),k=c("el-pagination"),I=M("loading");return y(),z("div",A,[o("div",L,[o("div",N,[j,o("span",E,d((g=l.detail)==null?void 0:g.title),1),O,o("span",F,d((f=(_=l.detail)==null?void 0:_.content)==null?void 0:f.method),1),a(r,{class:"ml-sm",underline:!1,type:"primary",href:(S=(b=l.detail)==null?void 0:b.content)==null?void 0:S.url,target:"_blank"},{default:i(()=>{var p,D;return[w(d((D=(p=l.detail)==null?void 0:p.content)==null?void 0:D.url),1)]}),_:1},8,["href"])]),a(s,{title:"\u786E\u5B9A\u6E05\u7A7A\u65E5\u5FD7\uFF1F",onConfirm:h.handleBatchDeleteConfirm},{reference:i(()=>[a(r,{underline:!1,type:"danger",class:"mr-sm"},{default:i(()=>[a(m,null,{default:i(()=>[a(u)]),_:1}),w(d(e.$t("\u6E05\u7A7A\u65E5\u5FD7")),1)]),_:1})]),_:1},8,["onConfirm"])]),B(a(v,{list:l.list,onOnSuccess:h.resetData},null,8,["list","onOnSuccess"]),[[I,l.loading]]),a(k,{class:"mt-md justify-center",background:"",layout:"total, sizes, prev, pager, next",total:l.total,"page-size":l.size,"onUpdate:pageSize":t[0]||(t[0]=p=>l.size=p),"current-page":l.page,"onUpdate:currentPage":t[1]||(t[1]=p=>l.page=p),onCurrentChange:h.getData,onSizeChange:h.handleSizeChange},null,8,["total","page-size","current-page","onCurrentChange","onSizeChange"])])}const Y=C(U,[["render",Q]]);export{Y as default};
