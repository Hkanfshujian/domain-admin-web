import{t as U,_ as D}from"./index.b928c30e.js";import{ah as o,o as f,c as k,V as t,P as a,F as $,a8 as x,O as v,a as h,T as V,U as p,S as R,ar as A,Q as T}from"./vendor-vue.cefe3aef.js";import"./element-plus.af689926.js";import"./element-icon.1fe9d2a8.js";import"./vendor-lib.a8c0b8df.js";const E={dns_type_id:[{message:"\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],name:[{message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],access_key:[{message:"Access Key\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],secret_key:[{message:"Secret Key\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],create_time:[{message:"\u521B\u5EFA\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]},F={ALIYUN:1},S=[{value:F.ALIYUN,label:U("\u963F\u91CC\u4E91")}],N={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{DNSTypeOptions:S,rules:E,form:{dns_type_id:S[0].value,name:"",access_key:"",secret_key:"",create_time:""}}},computed:{},methods:{async getData(){if(this.row){let s={dns_id:this.row.id};const e=await this.$http.getDnsById(s);if(e.code!=0)return;let n=e.data;this.form.dns_type_id=n.dns_type_id,this.form.name=n.name,this.form.access_key=n.access_key,this.form.secret_key=n.secret_key}},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(s=>{if(s)this.confirmSubmit();else return!1})},async confirmSubmit(){let s=this.$loading({fullscreen:!0}),e={dns_type_id:this.form.dns_type_id,name:this.form.name,access_key:this.form.access_key,secret_key:this.form.secret_key},n=null;this.row?(e.dns_id=this.row.id,n=await this.$http.updateDnsById(e)):n=await this.$http.addDns(e),n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg),this.$nextTick(()=>{s.close()})}},created(){this.getData()}},z={class:"text-center"};function B(s,e,n,g,l,i){const r=o("el-input"),u=o("el-form-item"),m=o("el-option"),y=o("el-select"),w=o("el-form"),b=o("el-button");return f(),k("div",null,[t(w,{ref:"form",model:l.form,rules:l.rules,"label-width":"100px"},{default:a(()=>[t(u,{label:"\u540D\u79F0",prop:"name"},{default:a(()=>[t(r,{type:"text",modelValue:l.form.name,"onUpdate:modelValue":e[0]||(e[0]=c=>l.form.name=c),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),t(u,{label:"\u7C7B\u578B",prop:"dns_type_id"},{default:a(()=>[t(y,{modelValue:l.form.dns_type_id,"onUpdate:modelValue":e[1]||(e[1]=c=>l.form.dns_type_id=c),placeholder:s.$t("\u8BF7\u9009\u62E9\u7C7B\u578B")},{default:a(()=>[(f(!0),k($,null,x(l.DNSTypeOptions,c=>(f(),v(m,{key:c.value,label:c.label,value:c.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),t(u,{label:"Access Key",prop:"access_key"},{default:a(()=>[t(r,{type:"text",modelValue:l.form.access_key,"onUpdate:modelValue":e[2]||(e[2]=c=>l.form.access_key=c),placeholder:"\u8BF7\u8F93\u5165Access Key"},null,8,["modelValue"])]),_:1}),t(u,{label:"Secret Key",prop:"secret_key"},{default:a(()=>[t(r,{type:"text",modelValue:l.form.secret_key,"onUpdate:modelValue":e[3]||(e[3]=c=>l.form.secret_key=c),placeholder:"\u8BF7\u8F93\u5165Secret Key"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),h("div",z,[t(b,{onClick:i.handleCancel},{default:a(()=>[V(p(s.$t("\u53D6\u6D88")),1)]),_:1},8,["onClick"]),t(b,{type:"primary",onClick:i.handleSubmit},{default:a(()=>[V(p(s.$t("\u786E\u5B9A")),1)]),_:1},8,["onClick"])])])}const K=D(N,[["render",B]]),q={name:"",props:{row:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible"],components:{DataForm:K},data(){return{}},computed:{dialogTitle(){return this.row?"\u7F16\u8F91":"\u6DFB\u52A0"},dialogVisible:{get(){return this.visible},set(s){this.$emit("update:visible",s)}}},methods:{handleClose(){this.$emit("update:visible",!1)},handleOpen(){this.$emit("update:visible",!0)},handleSuccess(){this.handleClose(),this.$emit("on-success")}},created(){}};function I(s,e,n,g,l,i){const r=o("DataForm"),u=o("el-dialog");return f(),v(u,{title:i.dialogTitle,modelValue:i.dialogVisible,"onUpdate:modelValue":e[0]||(e[0]=m=>i.dialogVisible=m),width:"400px",center:"","append-to-body":""},{default:a(()=>[i.dialogVisible?(f(),v(r,{key:0,row:n.row,onOnCancel:i.handleClose,onOnSuccess:i.handleSuccess},null,8,["row","onOnCancel","onOnSuccess"])):R("",!0)]),_:1},8,["title","modelValue"])}const C=D(q,[["render",I]]),j={name:"",components:{DataFormDialog:C},props:{list:{type:Array}},computed:{},data(){return{currentRow:null,dialogVisible:!1}},methods:{handleEditRow(s){this.currentRow=s,this.dialogVisible=!0},async handleDeleteClick(s){let e={dns_id:s.id};const n=await this.$http.deleteDnsById(e);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg)},async handleStatusChange(s){let e={id:s.id};const n=await this.$http.function(e);n.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(n.msg)},handleUpdateSuccess(){this.$emit("on-success")}},created(){}};function L(s,e,n,g,l,i){const r=o("el-table-column"),u=o("Edit"),m=o("el-icon"),y=o("el-link"),w=o("Delete"),b=o("el-popconfirm"),c=o("el-table"),_=o("DataFormDialog");return f(),k("div",null,[t(c,{data:n.list,stripe:"",border:""},{default:a(()=>[t(r,{label:"\u540D\u79F0","header-align":"center",align:"center",prop:"name"},{default:a(d=>[h("span",null,p(d.row.name||"-"),1)]),_:1}),t(r,{label:"\u7C7B\u578B","header-align":"center",align:"center",prop:"dns_type_id"},{default:a(d=>[h("span",null,p(d.row.dns_type_label||"-"),1)]),_:1}),t(r,{label:"Access Key","header-align":"center",align:"center",prop:"access_key"},{default:a(d=>[h("span",null,p(d.row.access_key||"-"),1)]),_:1}),t(r,{label:"Secret Key","header-align":"center",align:"center",prop:"secret_key"},{default:a(d=>[h("span",null,p(d.row.secret_key||"-"),1)]),_:1}),t(r,{label:"\u521B\u5EFA\u65F6\u95F4","header-align":"center",align:"center",prop:"create_time"},{default:a(d=>[h("span",null,p(d.row.create_time||"-"),1)]),_:1}),t(r,{label:"\u7F16\u8F91",width:"60","header-align":"center",align:"center"},{default:a(d=>[t(y,{underline:!1,type:"primary",onClick:O=>i.handleEditRow(d.row)},{default:a(()=>[t(m,null,{default:a(()=>[t(u)]),_:1})]),_:2},1032,["onClick"])]),_:1}),t(r,{label:"\u5220\u9664",width:"60",align:"center",prop:"tag"},{default:a(d=>[t(b,{title:`${s.$t("\u786E\u5B9A\u5220\u9664")}\uFF1F`,onConfirm:O=>i.handleDeleteClick(d.row)},{reference:a(()=>[t(y,{underline:!1,type:"danger"},{default:a(()=>[t(m,null,{default:a(()=>[t(w)]),_:1})]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),t(_,{visible:l.dialogVisible,"onUpdate:visible":e[0]||(e[0]=d=>l.dialogVisible=d),row:l.currentRow,onOnSuccess:i.handleUpdateSuccess},null,8,["visible","row","onOnSuccess"])])}const P=D(j,[["render",L]]),Y={name:"dns-list",props:{},components:{DataFormDialog:C,DataTable:P},data(){return{list:[],total:0,page:1,size:20,keyword:"",loading:!0,dialogVisible:!1}},computed:{},methods:{resetData(){this.page=1,this.getData()},async getData(){this.loading=!0;let s={page:this.page,size:this.size,keyword:this.keyword};try{const e=await this.$http.getDnsList(s);e.code==0&&(this.list=e.data.list.map(n=>{var g;return n.dns_type_label=(g=S.find(l=>l.value==n.dns_type_id))==null?void 0:g.label,n}),this.total=e.data.total)}catch(e){console.log(e)}finally{this.loading=!1}},handleAddRow(){this.dialogVisible=!0},handleAddSuccess(){this.resetData()},handleSearch(){this.resetData()},handleEditRow(s){}},created(){this.getData()}},Q={class:"app-container"},G={class:"flex justify-between"};function H(s,e,n,g,l,i){const r=o("Plus"),u=o("el-icon"),m=o("el-button"),y=o("DataTable"),w=o("el-pagination"),b=o("DataFormDialog"),c=A("loading");return f(),k("div",Q,[h("div",G,[t(m,{type:"primary",onClick:i.handleAddRow},{default:a(()=>[t(u,null,{default:a(()=>[t(r)]),_:1}),V(p(s.$t("\u6DFB\u52A0")),1)]),_:1},8,["onClick"])]),T(t(y,{class:"mt-md",list:l.list,onOnSuccess:i.resetData,onOnEditRow:i.handleEditRow},null,8,["list","onOnSuccess","onOnEditRow"]),[[c,l.loading]]),t(w,{class:"mt-md justify-center",background:"",layout:"total, prev, pager, next",total:l.total,"page-size":l.size,"onUpdate:pageSize":e[0]||(e[0]=_=>l.size=_),"current-page":l.page,"onUpdate:currentPage":e[1]||(e[1]=_=>l.page=_),onCurrentChange:i.getData},null,8,["total","page-size","current-page","onCurrentChange"]),t(b,{visible:l.dialogVisible,"onUpdate:visible":e[2]||(e[2]=_=>l.dialogVisible=_),onOnSuccess:i.handleAddSuccess},null,8,["visible","onOnSuccess"])])}const ee=D(Y,[["render",H]]);export{ee as default};
