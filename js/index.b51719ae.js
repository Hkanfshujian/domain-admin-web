import{t as U,_ as v}from"./index.8f559c24.js";import{ah as r,o as f,c as D,V as t,P as a,S as o,F as C,a8 as A,O,a as g,T as S,U as _,ar as K,Q as R}from"./vendor-vue.cefe3aef.js";import"./element-plus.af689926.js";import"./element-icon.1fe9d2a8.js";import"./vendor-lib.a8c0b8df.js";const T={dns_type_id:[{message:"\u7C7B\u578B\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],name:[{message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],access_key:[{message:"Access Key\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],secret_key:[{message:"Secret Key\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}],create_time:[{message:"\u521B\u5EFA\u65F6\u95F4\u4E0D\u80FD\u4E3A\u7A7A",required:!0,trigger:"blur"}]},E={ALIYUN:1},V=[{value:E.ALIYUN,label:U("\u963F\u91CC\u4E91")}],F={name:"",props:{row:{type:Object,default:null}},components:{},data(){return{DNSTypeOptions:V,rules:T,form:{dns_type_id:V[0].value,name:"",access_key:"",secret_key:"",create_time:""}}},computed:{},methods:{async getData(){if(this.row){let n={dns_id:this.row.id};const e=await this.$http.getDnsById(n);if(e.code!=0)return;let s=e.data;this.form.dns_type_id=s.dns_type_id,this.form.name=s.name,this.form.access_key=s.access_key,this.form.secret_key=s.secret_key}},handleCancel(){this.$emit("on-cancel")},handleSubmit(){this.$refs.form.validate(n=>{if(n)this.confirmSubmit();else return!1})},async confirmSubmit(){let n=this.$loading({fullscreen:!0}),e={dns_type_id:this.form.dns_type_id,name:this.form.name,access_key:this.form.access_key,secret_key:this.form.secret_key},s=null;this.row?(e.dns_id=this.row.id,s=await this.$http.updateDnsById(e)):s=await this.$http.addDns(e),s.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(s.msg),this.$nextTick(()=>{n.close()})}},created(){this.getData()}},N={class:"text-center"};function z(n,e,s,y,l,i){const c=r("el-input"),p=r("el-form-item"),m=r("el-option"),b=r("el-select"),k=r("el-form"),w=r("el-button");return f(),D("div",null,[t(k,{ref:"form",model:l.form,rules:l.rules,"label-width":"100px"},{default:a(()=>[o(" \u540D\u79F0 "),t(p,{label:"\u540D\u79F0",prop:"name"},{default:a(()=>[t(c,{type:"text",modelValue:l.form.name,"onUpdate:modelValue":e[0]||(e[0]=d=>l.form.name=d),placeholder:"\u8BF7\u8F93\u5165\u540D\u79F0"},null,8,["modelValue"])]),_:1}),o(" \u7C7B\u578B "),t(p,{label:"\u7C7B\u578B",prop:"dns_type_id"},{default:a(()=>[t(b,{modelValue:l.form.dns_type_id,"onUpdate:modelValue":e[1]||(e[1]=d=>l.form.dns_type_id=d),placeholder:n.$t("\u8BF7\u9009\u62E9\u7C7B\u578B")},{default:a(()=>[(f(!0),D(C,null,A(l.DNSTypeOptions,d=>(f(),O(m,{key:d.value,label:d.label,value:d.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),o(" Access Key "),t(p,{label:"Access Key",prop:"access_key"},{default:a(()=>[t(c,{type:"text",modelValue:l.form.access_key,"onUpdate:modelValue":e[2]||(e[2]=d=>l.form.access_key=d),placeholder:"\u8BF7\u8F93\u5165Access Key"},null,8,["modelValue"])]),_:1}),o(" Secret Key "),t(p,{label:"Secret Key",prop:"secret_key"},{default:a(()=>[t(c,{type:"text",modelValue:l.form.secret_key,"onUpdate:modelValue":e[3]||(e[3]=d=>l.form.secret_key=d),placeholder:"\u8BF7\u8F93\u5165Secret Key"},null,8,["modelValue"])]),_:1}),o(" \u521B\u5EFA\u65F6\u95F4 ")]),_:1},8,["model","rules"]),o(" \u64CD\u4F5C "),g("div",N,[t(w,{onClick:i.handleCancel},{default:a(()=>[S(_(n.$t("\u53D6\u6D88")),1)]),_:1},8,["onClick"]),t(w,{type:"primary",onClick:i.handleSubmit},{default:a(()=>[S(_(n.$t("\u786E\u5B9A")),1)]),_:1},8,["onClick"])])])}const B=v(F,[["render",z]]),I={name:"",props:{row:{type:Object,default:null},visible:{type:Boolean,default:!1}},emits:["update:visible"],components:{DataForm:B},data(){return{}},computed:{dialogTitle(){return this.row?"\u7F16\u8F91":"\u6DFB\u52A0"},dialogVisible:{get(){return this.visible},set(n){this.$emit("update:visible",n)}}},methods:{handleClose(){this.$emit("update:visible",!1)},handleOpen(){this.$emit("update:visible",!0)},handleSuccess(){this.handleClose(),this.$emit("on-success")}},created(){}};function q(n,e,s,y,l,i){const c=r("DataForm"),p=r("el-dialog");return f(),D(C,null,[o(" \u7F16\u8F91\u6846 "),t(p,{title:i.dialogTitle,modelValue:i.dialogVisible,"onUpdate:modelValue":e[0]||(e[0]=m=>i.dialogVisible=m),width:"400px",center:"","append-to-body":""},{default:a(()=>[i.dialogVisible?(f(),O(c,{key:0,row:s.row,onOnCancel:i.handleClose,onOnSuccess:i.handleSuccess},null,8,["row","onOnCancel","onOnSuccess"])):o("v-if",!0)]),_:1},8,["title","modelValue"])],2112)}const $=v(I,[["render",q]]),j={name:"",components:{DataFormDialog:$},props:{list:{type:Array}},computed:{},data(){return{currentRow:null,dialogVisible:!1}},methods:{handleEditRow(n){this.currentRow=n,this.dialogVisible=!0},async handleDeleteClick(n){let e={dns_id:n.id};const s=await this.$http.deleteDnsById(e);s.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(s.msg)},async handleStatusChange(n){let e={id:n.id};const s=await this.$http.function(e);s.code==0?(this.$msg.success("\u64CD\u4F5C\u6210\u529F"),this.$emit("on-success")):this.$msg.error(s.msg)},handleUpdateSuccess(){this.$emit("on-success")}},created(){}};function L(n,e,s,y,l,i){const c=r("el-table-column"),p=r("Edit"),m=r("el-icon"),b=r("el-link"),k=r("Delete"),w=r("el-popconfirm"),d=r("el-table"),h=r("DataFormDialog");return f(),D("div",null,[t(d,{data:s.list,stripe:"",border:""},{default:a(()=>[o(` <el-table-column
        label="ID"
        align="center"
        prop="id"
        width="60"
      >
        <template #default="scope">
          <span>{{ scope.row.id || '-' }}</span>
        </template>
      </el-table-column> `),o(" \u540D\u79F0 "),t(c,{label:"\u540D\u79F0","header-align":"center",align:"center",prop:"name"},{default:a(u=>[g("span",null,_(u.row.name||"-"),1)]),_:1}),o(" \u7C7B\u578B "),t(c,{label:"\u7C7B\u578B","header-align":"center",align:"center",prop:"dns_type_id"},{default:a(u=>[g("span",null,_(u.row.dns_type_label||"-"),1)]),_:1}),o(" Access Key "),t(c,{label:"Access Key","header-align":"center",align:"center",prop:"access_key"},{default:a(u=>[g("span",null,_(u.row.access_key||"-"),1)]),_:1}),o(" Secret Key "),t(c,{label:"Secret Key","header-align":"center",align:"center",prop:"secret_key"},{default:a(u=>[g("span",null,_(u.row.secret_key||"-"),1)]),_:1}),o(" \u521B\u5EFA\u65F6\u95F4 "),t(c,{label:"\u521B\u5EFA\u65F6\u95F4","header-align":"center",align:"center",prop:"create_time"},{default:a(u=>[g("span",null,_(u.row.create_time||"-"),1)]),_:1}),o(" \u64CD\u4F5C "),o(` <el-table-column
        label="\u72B6\u6001"
        header-align="center"
        align="center"
        width="80"
      >
        <template #default="scope">
          <el-switch
            v-model="scope.row.status"
            @change="handleStatusChange(scope.row, $event)"
          />
        </template>
      </el-table-column> `),t(c,{label:"\u7F16\u8F91",width:"60","header-align":"center",align:"center"},{default:a(u=>[t(b,{underline:!1,type:"primary",onClick:x=>i.handleEditRow(u.row)},{default:a(()=>[t(m,null,{default:a(()=>[t(p)]),_:1})]),_:2},1032,["onClick"])]),_:1}),t(c,{label:"\u5220\u9664",width:"60",align:"center",prop:"tag"},{default:a(u=>[t(w,{title:`${n.$t("\u786E\u5B9A\u5220\u9664")}\uFF1F`,onConfirm:x=>i.handleDeleteClick(u.row)},{reference:a(()=>[t(b,{underline:!1,type:"danger"},{default:a(()=>[t(m,null,{default:a(()=>[t(k)]),_:1})]),_:1})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),o(" \u7F16\u8F91\u6846 "),t(h,{visible:l.dialogVisible,"onUpdate:visible":e[0]||(e[0]=u=>l.dialogVisible=u),row:l.currentRow,onOnSuccess:i.handleUpdateSuccess},null,8,["visible","row","onOnSuccess"])])}const P=v(j,[["render",L]]),Y={name:"dns-list",props:{},components:{DataFormDialog:$,DataTable:P},data(){return{list:[],total:0,page:1,size:20,keyword:"",loading:!0,dialogVisible:!1}},computed:{},methods:{resetData(){this.page=1,this.getData()},async getData(){this.loading=!0;let n={page:this.page,size:this.size,keyword:this.keyword};try{const e=await this.$http.getDnsList(n);e.code==0&&(this.list=e.data.list.map(s=>{var y;return s.dns_type_label=(y=V.find(l=>l.value==s.dns_type_id))==null?void 0:y.label,s}),this.total=e.data.total)}catch(e){console.log(e)}finally{this.loading=!1}},handleAddRow(){this.dialogVisible=!0},handleAddSuccess(){this.resetData()},handleSearch(){this.resetData()},handleEditRow(n){}},created(){this.getData()}},Q={class:"app-container"},G={class:"flex justify-between"};function H(n,e,s,y,l,i){const c=r("Plus"),p=r("el-icon"),m=r("el-button"),b=r("DataTable"),k=r("el-pagination"),w=r("DataFormDialog"),d=K("loading");return f(),D("div",Q,[o(" \u64CD\u4F5C\u6309\u94AE "),g("div",G,[t(m,{type:"primary",onClick:i.handleAddRow},{default:a(()=>[t(p,null,{default:a(()=>[t(c)]),_:1}),S(_(n.$t("\u6DFB\u52A0")),1)]),_:1},8,["onClick"]),o(` <el-input
        class="ml-sm"
        style="width: 260px"
        v-model="keyword"
        placeholder="\u8F93\u5165\u57DF\u540D"
        clearable
        @keypress.enter="handleSearch"
        @clear="handleSearch"
      >
        <template #append>
          <el-button @click="handleSearch">
            <el-icon><Search /></el-icon
          ></el-button>
        </template>
      </el-input> `)]),o(" \u6570\u636E\u5217\u8868 "),R(t(b,{class:"mt-md",list:l.list,onOnSuccess:i.resetData,onOnEditRow:i.handleEditRow},null,8,["list","onOnSuccess","onOnEditRow"]),[[d,l.loading]]),o(" \u7FFB\u9875 "),t(k,{class:"mt-md justify-center",background:"",layout:"total, prev, pager, next",total:l.total,"page-size":l.size,"onUpdate:pageSize":e[0]||(e[0]=h=>l.size=h),"current-page":l.page,"onUpdate:currentPage":e[1]||(e[1]=h=>l.page=h),onCurrentChange:i.getData},null,8,["total","page-size","current-page","onCurrentChange"]),o(" \u7F16\u8F91\u6846 "),t(w,{visible:l.dialogVisible,"onUpdate:visible":e[2]||(e[2]=h=>l.dialogVisible=h),onOnSuccess:i.handleAddSuccess},null,8,["visible","onOnSuccess"])])}const ee=v(Y,[["render",H]]);export{ee as default};
